import{i as D,g as d,u as I,r as _,o as N,a as l,b as $,c as C,p as V,d as p,e as f,f as s,h as B,w as j,k as w,t as m,l as q,m as O,F as A,n as E,q as g,s as L,v as P,x as v,_ as z}from"./index-dee2965c.js";import{S as k}from"./sweetalert2.all-4088fd79.js";const M={class:"p-4 text-white"},F=s("div",{class:"p-4 mt-4 rounded flex justify-between items-center border border-gray-400"},[s("span",{class:"inline-block font-bold font-sans text-xl"},"Dashborad 管理獎項")],-1),W={class:"flex flex-col flex-wrap justify-evenly"},G={class:"flex flex-row m-4"},K={class:"text-xl font-bold p-1 border-b border-white"},Z=["onClick"],H=s("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-5 h-5"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 4.5v15m7.5-7.5h-15"})],-1),J=["onClick"],Q=s("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-5 h-5"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 4.5v15m7.5-7.5h-15"})],-1),X=["onClick"],se={__name:"AdminAwardsView",setup(Y){const R=D({apiKey:"AIzaSyCngOWSZwnTjBGqx3BehB5PeqTg7qENDLI",authDomain:"earnest-runner-189507.firebaseapp.com",databaseURL:"https://earnest-runner-189507.firebaseio.com",projectId:"earnest-runner-189507",storageBucket:"earnest-runner-189507.appspot.com",messagingSenderId:"142419818564",appId:"1:142419818564:web:6b1035fd5a5e3d3d5ce411"});d(R);const y=I(),h=_(0),b=_(1);N(async()=>{b.value=1,await y.isReady();const t=y.currentRoute.value.params.year,o=l(d());$(C(o,`${t}/`)).then(a=>{a.exists()&&(h.value=Object.entries(a.val()).sort((e,r)=>e[1].order-r[1].order),b.value=0)})});function S(t,o){const a=d();(async()=>{const{value:e}=await k.fire({input:"textarea",inputLabel:"新增──"+o,inputPlaceholder:"Type your message here...",inputAttributes:{"aria-label":"Type your message here"},showCancelButton:!0});if(e){let r=e.trim().split(`
`),i="";const x=l(d());await $(C(x,`${t}/${o}`)).then(n=>{n.exists()&&(i=n.val().imageUrl,L(l(a,`${t}/${o}`),{}),L(l(a,`${t}/${o}`),{imageUrl:i}))});const c=[];r.forEach(n=>{const u=P(l(a,`${t}/${o}`),{artworks:n,won:!1});c.push(u)}),Promise.all(c).then(()=>{location.reload()})}})()}function T(t,o){const a=d();(async()=>{const{value:e}=await k.fire({input:"textarea",inputLabel:"新增圖片──"+o,inputPlaceholder:"Type your url here...",inputAttributes:{"aria-label":"Type your message here"},showCancelButton:!0});e&&v(l(a,`${t}/${o}`),{imageUrl:e}).then(()=>{location.reload()})})()}function U(t,o,a){const e=/[-\/\\^$*+?.()|[\]{}]/g,r=a.replace(e,"\\$&");console.log(t),console.log(o),console.log(r);const i=d();(async()=>await k.fire({title:"修改得獎者──<br>"+r,showCancelButton:!0,confirmButtonText:"Save"}).then(x=>{if(x.isConfirmed){let c=[];h.value.forEach(n=>{n[0].match(o)&&(c=Object.keys(n[1]).filter(u=>u.length>9))}),c.forEach(n=>{v(l(i,`${t}/${o}/${n}`),{won:!1})}),h.value.forEach(n=>{n[0].match(o)&&c.forEach(u=>{n[1][u].artworks.match(r)&&v(l(i,`${t}/${o}/${u}`),{won:!0})})})}}))()}return(t,o)=>{const a=V("RouterLink");return p(),f("main",M,[s("span",null,[B(a,{to:"/",class:"inline-block text-blue-300"},{default:j(()=>[w(" 首頁 ")]),_:1}),w(" / "),B(a,{to:"/Admin",class:"inline-block text-blue-300"},{default:j(()=>[w(" Admin ")]),_:1}),w(" / "+m(t.$route.params.year)+"年 ",1)]),F,s("div",W,[b.value===1?(p(),q(z,{key:0})):O("",!0),(p(!0),f(A,null,E(h.value,e=>(p(),f("div",{class:"relative flex flex-col items-center justify-center bg-black mt-4 border rounded",key:e.id},[s("div",G,[s("span",K,m(e[0]),1),s("button",{type:"button",class:"w-[80px] mr-[1px] pl-1 pr-2 py-2 space-x-1 flex flex-row rounded text-white ease-in-out hover:bg-opacity-10 border-white border",onClick:r=>S(t.$route.params.year,e[0])},[H,s("span",{class:g([Object.keys(e[1]).length!==1?"text-custom-gold":"text-white"])},"提名",2)],8,Z),s("button",{type:"button",class:"w-[80px] mr-[1px] pl-1 pr-2 py-2 space-x-1 flex flex-row rounded text-white ease-in-out hover:bg-opacity-10 border-white border",onClick:r=>T(t.$route.params.year,e[0])},[Q,s("span",{class:g([e[1].imageUrl?"text-custom-gold":"text-white"])},"圖片",2)],8,J)]),(p(!0),f(A,null,E(e[1],r=>(p(),f("div",{class:"flex flex-col m-2",key:e.id},[s("span",{onClick:i=>U(t.$route.params.year,e[0],r.artworks),class:g(["cursor-pointer hover:bg-slate-400",r.won?"text-custom-gold":"text-white"])},m(r.artworks),11,X)]))),128))]))),128))])])}}};export{se as default};
